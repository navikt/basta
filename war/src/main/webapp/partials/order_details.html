<div ng-controller="orderListController">
    <div class="container-fluid">
        <div ng-hide="exists">
            <h1 class="page-header">
                Ordre #{{routeParamsId}} finnes ikke
            </h1>
        </div>
        <div ng-show="exists">

            <h1 class="page-header">Ordre #{{orderDetails.id}}
                <small>{{orderDetails.nodeType}}</small>
            </h1>
            <div class="row">
                <div class="col-lg-6 panel-group" id="statusPanel">
                    <div ng-class="
                {'panel  panel-danger': orderDetails.bootstrapClass === 'danger',
                 'panel panel-primary': orderDetails.bootstrapClass === 'success',
                  'panel panel-info': orderDetails.bootstrapClass === 'info' ||  orderDetails.bootstrapClass === 'active'}">
                        <div class="panel-heading">
                            <h2 class="panel-title">
                                <i ng-class="
                       {'glyphicon  glyphicon-exclamation-sign': orderDetails.bootstrapClass === 'danger',
                        'glyphicon glyphicon-ok': orderDetails.bootstrapClass === 'success',
                        'glyphicon glyphicon-refresh': orderDetails.bootstrapClass === 'info' ||  orderDetails.bootstrapClass === 'active'}"/>
                                <a data-toggle="collapse" data-parent="#statusPanel" href="#statusContent"
                                   onclick="return false;">
                                    {{orderDetails.status}}
                                </a>
                            </h2>
                        </div>
                        <div id="statusContent" class="panel-collapse collapse in">
                            <div class="panel-body" ng-show="orderDetails.errorMessage">
                                <div class="alert alert-danger">{{orderDetails.errorMessage}}</div>
                            </div>
                            <table class="table">
                                <thead></thead>
                                <tbody>
                                <tr>
                                    <th class="col-lg-3">Orchestrator ID</th>
                                    <td class="col-lg-9">{{orderDetails.orchestratorOrderId}}</td>
                                </tr>
                                <tr>
                                    <th>Opprettet av</th>
                                    <td>{{orderDetails.createdBy}}</td>
                                </tr>
                                <tr>
                                    <th>Opprettet dato</th>
                                    <td>{{orderDetails.created|date:'yyyy-MM-dd HH:mm:ss'}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
                <div class="col-lg-6 panel-group" id="nodePanel">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h2 class="panel-title">
                                <i class="glyphicon  glyphicon-map-marker"/>
                                <a data-toggle="collapse" data-parent="#nodePanel" href="#nodeContent"
                                   onclick="return false;">
                                    Noder
                                </a>
                            </h2>
                        </div>
                        <div id="nodeContent" class="panel-collapse collapse in">
                            <div class="panel-body" ng-hide="orderDetails.nodes">
                                (Ingen noder)
                            </div>
                            <table class="table" ng-show="orderDetails.nodes">
                                <thead>
                                <tr>
                                    <th>Host</th>
                                    <th>Minne</th>
                                    <th>CPU'er</th>
                                    <th>Admin</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="node in orderDetails.nodes">
                                    <td>{{node.hostname}}</td>
                                    <td>{{node.memoryMb}}Mb</td>
                                    <td>{{node.cpuCount}}</td>
                                    <td><a ng-show="node.adminUrl" href="{{node.adminUrl}}" target="_blank"><i
                                            class="icon-share"></i> lenke</a>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-6 panel-group" id="requestPanel">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h2 class="panel-title">
                                <i class="glyphicon  glyphicon-list-alt"/>
                                <a data-toggle="collapse" data-parent="#requestPanel" href="#requestContent"
                                   onclick="return false;">
                                    Request
                                </a>
                        <span class="pull-right">
                            <span class="switch-label">
                            Vis XML?
                            </span>
                            <toggle-switch
                                    model="showXML"
                                    knob-label="XML"
                                    on-label="Ja"
                                    off-label="Nei">
                                >
                            </toggle-switch>
                        </span>
                            </h2>

                        </div>
                        <div id="requestContent" class="panel-collapse collapse in">
                            <pre ng-show="showXML">{{orderDetails.requestXml}}</pre>
                            <table ng-hide="showXML" class="table">
                                <thead></thead>
                                <tbody>
                                <tr ng-repeat="(key, value) in orderDetails.settings" ng-show="value">
                                    <th class="col-lg-3">{{key}}</th>
                                    <td class="col-lg-9">{{value}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>


                <div class="col-lg-6 panel-group" id="logPanel">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <h2 class="panel-title">
                                <i class="glyphicon  glyphicon-transfer"/>
                                <a data-toggle="collapse" data-parent="#logPanel" href="#logContent"
                                   onclick="return false;">
                                    Statuslogg fra Orchestrator
                                </a>
                            </h2>
                        </div>
                        <div id="logContent" class="panel-collapse collapse in">
                            <div class="panel-body" ng-show="statusLog.length===0">
                                (Ingen logg)
                            </div>
                            <table class="table" ng-hide="statusLog.length===0"
                                   ng-init="predicate = 'id'; reverse = false">
                                <thead>
                                <tr>
                                    <th><a ng-click="reverse = predicate == (predicate = 'id') && !reverse">#</a></th>
                                    <th>Tidspunkt</th>
                                    <th>Tekst</th>
                                    <th>Type</th>
                                    <th>Option</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="log in statusLog | orderBy:predicate:reverse"
                                    ng-class="{'danger': log.option === 'error'}">
                                    <td>{{log.id}}</td>
                                    <td>{{log.created|date:'yyyy-MM-dd HH:mm:ss'}}</td>
                                    <td>{{log.text}}</td>
                                    <td>{{log.type}}</td>
                                    <td>{{log.option}}</td>
                                </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>